<?xml version="1.0" encoding="UTF-8" ?>
<XMLDB PATH="mod/commitment/db" VERSION="2025112500" COMMENT="Schema for mod_commitment">
  <TABLES>
    <TABLE NAME="commitment" COMMENT="Commitments">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true" />
        <FIELD NAME="courseid" TYPE="int" LENGTH="10" NOTNULL="true" />
        <FIELD NAME="userid" TYPE="int" LENGTH="10" NOTNULL="true" />
        <FIELD NAME="name" TYPE="char" LENGTH="255" NOTNULL="true" />
        <FIELD NAME="description" TYPE="text" />
        <FIELD NAME="starttime" TYPE="int" LENGTH="10" NOTNULL="false" />
        <FIELD NAME="endtime" TYPE="int" LENGTH="10" NOTNULL="false" />
        <FIELD NAME="periodicity" TYPE="char" LENGTH="20" NOTNULL="true" DEFAULT="once" />
        <FIELD NAME="visibility" TYPE="int" LENGTH="2" NOTNULL="true" DEFAULT="1" />
        <FIELD NAME="referee" TYPE="int" LENGTH="10" NOTNULL="false" />
        <FIELD NAME="status" TYPE="char" LENGTH="20" NOTNULL="true" DEFAULT="active" />
        <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" />
        <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="false" />
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id" />
      </KEYS>
    </TABLE>

    <TABLE NAME="commitment_period" COMMENT="Periods per commitment">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true" />
        <FIELD NAME="commitmentid" TYPE="int" LENGTH="10" NOTNULL="true" />
        <FIELD NAME="periodstart" TYPE="int" LENGTH="10" NOTNULL="true" />
        <FIELD NAME="periodend" TYPE="int" LENGTH="10" NOTNULL="true" />
        <FIELD NAME="status" TYPE="char" LENGTH="20" NOTNULL="true" DEFAULT="open" />
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id" />
      </KEYS>
    </TABLE>

    <TABLE NAME="commitment_report" COMMENT="Reports submitted by students">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true" />
        <FIELD NAME="periodid" TYPE="int" LENGTH="10" NOTNULL="true" />
        <FIELD NAME="userid" TYPE="int" LENGTH="10" NOTNULL="true" />
        <FIELD NAME="reporttext" TYPE="text" />
        <FIELD NAME="evidencefileid" TYPE="int" LENGTH="10" NOTNULL="false" />
        <FIELD NAME="reporttime" TYPE="int" LENGTH="10" NOTNULL="true" />
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id" />
      </KEYS>
    </TABLE>

    <TABLE NAME="commitment_validation" COMMENT="Validations by referee/teacher">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true" />
        <FIELD NAME="reportid" TYPE="int" LENGTH="10" NOTNULL="true" />
        <FIELD NAME="validatorid" TYPE="int" LENGTH="10" NOTNULL="true" />
        <FIELD NAME="status" TYPE="char" LENGTH="20" NOTNULL="true" DEFAULT="pending" />
        <FIELD NAME="comment" TYPE="text" />
        <FIELD NAME="time" TYPE="int" LENGTH="10" NOTNULL="true" />
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id" />
      </KEYS>
    </TABLE>

    <TABLE NAME="commitment_actionlog" COMMENT="Audit log">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true" />
        <FIELD NAME="commitmentid" TYPE="int" LENGTH="10" NOTNULL="true" />
        <FIELD NAME="action" TYPE="char" LENGTH="50" NOTNULL="true" />
        <FIELD NAME="payload" TYPE="text" />
        <FIELD NAME="time" TYPE="int" LENGTH="10" NOTNULL="true" />
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id" />
      </KEYS>
    </TABLE>

  </TABLES>
</XMLDB>
